# AWS VPN Server module

Module to provision vpn service on aws


## Software dependencies

The module depends on the following software components:

### Terraform version

- \>= v0.15

### Terraform providers


- aws (hashicorp/aws)

### Module dependencies


- aws-vpc - [github.com/cloud-native-toolkit/terraform-aws-vpc](https://github.com/cloud-native-toolkit/terraform-aws-vpc) (>= 1.0.0)
- aws-vpc-subnets - [github.com/cloud-native-toolkit/terraform-aws-vpc-subnets](https://github.com/cloud-native-toolkit/terraform-aws-vpc-subnets) (>= 1.0.0)
- aws-client-vpn - [github.com/cloud-native-toolkit/terraform-aws-vpn-server](https://github.com/cloud-native-toolkit/terraform-aws-vpn-server) (>= 1.0.0)

## Example usage

```hcl
module "vpn" {
  source = "github.com/cloud-native-toolkit/terraform-aws-vpn-server"

  additional_routes = var.vpn_additional_routes == null ? null : jsondecode(var.vpn_additional_routes)
  allowed_cidr_ranges = var.vpn_allowed_cidr_ranges == null ? null : jsondecode(var.vpn_allowed_cidr_ranges)
  authentication_saml_provider_arn = var.vpn_authentication_saml_provider_arn
  authentication_type = var.vpn_authentication_type
  client_cidr_block = var.vpn_client_cidr_block
  create_vpn = var.vpn_create_vpn
  dns_servers = var.vpn_dns_servers == null ? null : jsondecode(var.vpn_dns_servers)
  existing_vpn_id = var.vpn_existing_vpn_id
  ingress_rules = var.vpn_ingress_rules == null ? null : jsondecode(var.vpn_ingress_rules)
  log_group_name = var.vpn_log_group_name
  logs_retention = var.vpn_logs_retention
  name_prefix = var.vpn_name_prefix
  name_vpn = var.vpn_name_vpn
  number_additional_routes = var.vpn_number_additional_routes
  number_subnets_association = var.vpn_number_subnets_association
  region = var.vpn_region
  resource_group_name = var.vpn_resource_group_name
  security_group_id = var.vpn_security_group_id
  split_tunnel = var.vpn_split_tunnel
  subnet_ids = module.worker_subnets.subnet_ids
  vpc_id = module.aws-vpc.vpc_id
}

```

## Module details

### Inputs

| Name | Description | Required | Default | Source |
|------|-------------|---------|----------|--------|
| region | The deployment region | true |  |  |
| subnet_ids | Subnet ID to associate clients (each subnet passed will create an VPN association -costs involved) | false |  | aws-vpc-subnets.subnet_ids |
| additional_routes | List of additonal routes to add in VPN | false |  |  |
| number_additional_routes | cont of additonal routes to add in VPN | false | 0 |  |
| allowed_cidr_ranges | List of CIDR ranges from which access is allowed. | false |  |  |
| vpc_id | VPC Id to create resources | true |  | aws-vpc.vpc_id |
| create_vpn | Indicates whether you want to  create vpn | false | true |  |
| existing_vpn_id | VPC Id to create resources | true |  | aws-client-vpn.vpn_endpoint_id |
| security_group_id | ID of the base security group(SG) to use for the VPN services,If not provided a new SG  will be created. | true |  |  |
| ingress_rules |  | false | [] |  |
| client_cidr_block | client cidr block for vpn | false | 172.63.0.0/16 |  |
| logs_retention | Retention in days for CloudWatch Log Group | false | 365 |  |
| log_group_name | Name for vpn log gruop | true |  |  |
| name_vpn | Name of resource  VPN to create | true |  |  |
| authentication_type | The type of client authentication to be used. Specify certificate-authentication to use certificate-based authentication, directory-service-authentication to use Active Directory authentication, or federated-authentication to use Federated Authentication via SAML 2.0. | false | "certificate-authentication" |  |
| authentication_saml_provider_arn | (Optional) The ARN of the IAM SAML identity provider if type is federated-authentication. | false | null |  |
| resource_group_name | The name of the resource group where the VPC is deployed. On AWS this value becomes a tag. | false | default |  |
| split_tunnel | With split_tunnel false, all client traffic will go through the VPN. | false | true |  |
| number_subnets_association | list of subnets to attch with vpn | false | 0 |  |
| dns_servers | List of DNS Servers. | false |  |  |
| name_prefix | Prefix to be added to the names of resources which are being provisioned | true |  |  |

### Outputs

| Name | Description |
|------|-------------|
| vpn_server | The arn of acm certificate server |
| vpn_client | The arn of acm certificate client |
| sec_id |  |
| vpn_endpoint_id |  |

## Resources

- [Documentation](https://operate.cloudnativetoolkit.dev)
- [Module catalog](https://modules.cloudnativetoolkit.dev)

> License: Apache License 2.0 | Generated by iascable (0.1.5)
